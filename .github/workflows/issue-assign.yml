name: Issue Assign / Unassign Bot

on:
  issue_comment:
    types: [created]

permissions:
  issues: write
  # Safe additions for comments
  pull-requests: write
jobs:
  assign-handler:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      - name: Debug checkout
        run: |
          pwd
          ls -la .ci/
          ls -la .github/workflows/
          cat .ci/issue-assign.js | head -10 || echo "NO JS FILE"
      - name: Run assign bot
        uses: actions/github-script@v7
        with:
          script: |-
            console.log("Working dir:", process.cwd());
            console.log("Files:", require('fs').readdirSync('.'));
            try {
              console.log("Loading .ci/issue-assign.js...");
              const handler = require('./.ci/issue-assign.js');
              console.log("JS loaded, calling handler...");
              await handler({github, context});
              console.log("Handler complete");
            } catch (error) {
              console.error("JS ERROR:", error.message);
              console.error("Stack:", error.stack);
              throw error;
            }
